<!DOCTYPE html>
<html lang="zh-CN">
  <head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8">
<!-- hexo-inject:begin --><!-- hexo-inject:end --><meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="csps2019复习特别项目-数论模板"><meta name="keywords" content="数论, 总结, Lemir3's blog"><link rel="alternate" href="/atom.xml" title="Lemir3's blog"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0">
<link rel="canonical" href="https://www.lemir3.red/2019/10/20/csps2019-fu-xi-te-bie-xiang-mu-shu-lun-mo-ban/">

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css"><script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0">

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":"","latex":true};
</script>

    <title>csps2019复习特别项目-数论模板 - Lemir3's blog</title>
  <link rel="alternate" href="/atom.xml" title="Lemir3's blog" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="mobile-header-logo">
    <a href="/." class="logo">Lemir3's blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">Home
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">Archives
          </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags
          </li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories
          </li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About
          </li>
      </a><a href="/links/">
        <li class="mobile-menu-item">Links
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Lemir3's blog</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            Home
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            Archives
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            Tags
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/categories/">
            Categories
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about/">
            About
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/links/">
            Links
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><article class="post">
    <header class="post-header">
      <h1 class="post-title">csps2019复习特别项目-数论模板
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-10-20
        </span><span class="post-category">
            <a href="/categories/数论/">数论</a>
            <a href="/categories/数论/数论-总结/">数论-总结</a>
            </span>
        </div>
    </header>

    <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">Contents</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#扩展欧几里得算法"><span class="toc-text">扩展欧几里得算法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#思想"><span class="toc-text">思想</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码"><span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#线性筛"><span class="toc-text">线性筛</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#思想-1"><span class="toc-text">思想</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码-1"><span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#欧拉函数"><span class="toc-text">欧拉函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#思想-2"><span class="toc-text">思想</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码-2"><span class="toc-text">代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#分解质因数求法"><span class="toc-text">分解质因数求法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#线性筛求法"><span class="toc-text">线性筛求法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#乘法逆元"><span class="toc-text">乘法逆元</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#思想-3"><span class="toc-text">思想</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码-3"><span class="toc-text">代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#费马定理求法"><span class="toc-text">费马定理求法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#线性求法"><span class="toc-text">线性求法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#欧拉定理"><span class="toc-text">欧拉定理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#思想-4"><span class="toc-text">思想</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码-4"><span class="toc-text">代码</span></a></li></ol></li></ol>
    </div>
  </div><div class="post-content"><p>摘要:总结了一些提高组范围内的数论</p>
<a id="more"></a>
<h1 id="扩展欧几里得算法"><a href="#扩展欧几里得算法" class="headerlink" title="扩展欧几里得算法"></a>扩展欧几里得算法</h1><h2 id="思想"><a href="#思想" class="headerlink" title="思想"></a>思想</h2><p>先奉上李哥讲的$exgcd$.</p>
<blockquote>
<p>基本算法：对于不完全为 0 的非负整数 a，b，gcd（a，b）表示 a，b 的最大公约数，必然存在整数对 x，y ，使得 gcd（a，b）=ax+by。</p>
<p>证明：设 a&gt;b。</p>
<p>　　1，显然当 b=0，gcd（a，b）=a。此时 x=1，y=0；</p>
<p>　　2，ab!=0 时</p>
<p>　　设 ax1+by1=gcd(a,b);</p>
<p>　　bx2+(a mod b)y2=gcd(b,a mod b);</p>
<p>　　根据朴素的欧几里德原理有 gcd(a,b)=gcd(b,a mod b);</p>
<p>　　则:ax1+by1=bx2+(a mod b)y2;</p>
<p>　　即:ax1+by1=bx2+(a-(a/b)<em>b)y2=ay2+bx2-(a/b)</em>by2;</p>
<p>　　根据恒等定理得：x1=y2; y1=x2-(a/b)*y2;</p>
<p>这样我们就得到了求解 x1,y1 的方法：x1，y1 的值基于 x2，y2.</p>
<p>　  上面的思想是以递归定义的，因为 gcd 不断的递归求解一定会有个时候 b=0，所以递归可以结束。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="function"><span class="keyword">int</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line">&gt;&#123;</span><br><span class="line">&gt;    <span class="keyword">if</span>(b==<span class="number">0</span>)</span><br><span class="line">&gt;    &#123;</span><br><span class="line">&gt;        x=<span class="number">1</span>;</span><br><span class="line">&gt;        y=<span class="number">0</span>;</span><br><span class="line">&gt;        <span class="keyword">return</span> a;</span><br><span class="line">&gt;    &#125;</span><br><span class="line">&gt;    <span class="keyword">int</span> r=exgcd(b,a%b,x,y);</span><br><span class="line">&gt;    <span class="keyword">int</span> t=x;</span><br><span class="line">&gt;    x=y;</span><br><span class="line">&gt;    y=t-a/b*y;</span><br><span class="line">&gt;    <span class="keyword">return</span> r;</span><br><span class="line">&gt;&#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>可以用来得出形如$ax + by = 1$的不定方程的一组解,或者是形如$ax \equiv 1  ( mod  b )$的最小整数解.</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>求后者的代码如下:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cctype"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"queue"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"map"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"vector"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stack"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"set"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) printf(<span class="meta-string">"debug:%lld\n"</span>,x)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> lxl <span class="title">read</span><span class="params">()</span></span>&#123;<span class="keyword">char</span> c=getchar();lxl f=<span class="number">1</span>,output=<span class="number">0</span>;<span class="keyword">for</span>(;!<span class="built_in">isdigit</span>(c);c=getchar())<span class="keyword">if</span>(c==<span class="string">'-'</span>)f=<span class="number">-1</span>;<span class="keyword">for</span>(;<span class="built_in">isdigit</span>(c);c=getchar())output=(output&lt;&lt;<span class="number">1</span>)+(output&lt;&lt;<span class="number">3</span>)+c-<span class="string">'0'</span>;<span class="keyword">return</span> output*f;&#125;</span><br><span class="line"></span><br><span class="line">lxl a,b,x,y;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> lxl <span class="title">exgcd</span><span class="params">(lxl a,lxl b,lxl &amp;x,lxl &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(b==<span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		x=<span class="number">1</span>;</span><br><span class="line">		y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">	&#125;</span><br><span class="line">	lxl r=exgcd(b,a%b,x,y),t=x;</span><br><span class="line">	x=y;</span><br><span class="line">	y=t-(a/b)*y;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	a=read(),b=read();</span><br><span class="line">	exgcd(a,b,x,y);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,(x+b)%b);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="线性筛"><a href="#线性筛" class="headerlink" title="线性筛"></a>线性筛</h1><h2 id="思想-1"><a href="#思想-1" class="headerlink" title="思想"></a>思想</h2><p>通过”从大到小累积质因子”的方式标记每个合数,用数组$v$记录每个数的最小质因子,按以下步骤维护$v$:</p>
<ol>
<li><p>依次遍历$1$到$n$中的每一个数. </p>
</li>
<li><p>如果$v_{i} = i$,说明$i$是质数,把它记录下来.</p>
</li>
<li><p>扫描不大于$v_{i}$的每个质数$p$,令$v_{i \times p}$等于$p$,即在$i$的基础上累积一个质因子$p$,因为$p$小于等于$v_{i}$,所以$p$就是合数$i \times p$的最小质因子.</p>
</li>
</ol>
<h2 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">GetPrime</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(R lxl i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(!v[i])</span><br><span class="line">		&#123;</span><br><span class="line">			prime[++cnt]=i;</span><br><span class="line">			v[i]=i;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(R lxl j=<span class="number">1</span>;j&lt;=cnt;++j)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(prime[j]&gt;v[i]||n/i&lt;prime[j])<span class="keyword">break</span>;</span><br><span class="line">			v[prime[j]*i]=prime[j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h1><h2 id="思想-2"><a href="#思想-2" class="headerlink" title="思想"></a>思想</h2><p>$1$到$n$中与$n$互质的数的个数成为$n$的欧拉函数,记为$\varphi ( n )$.</p>
<p>证法略,这里写两种求法.</p>
<p>一种根据欧拉函数的递推式$\varphi ( n ) = \prod_{p \mid n} ( 1 - \frac{1}{p} )$,通过分解质因数求出.</p>
<p>另一种通过两条积性函数的性质,用线筛$O ( n )$求出$1$到$n$中每个数的欧拉函数.</p>
<p>性质如下:</p>
<ol>
<li><p>$p$为质数,若$p \mid n$且$p^{2} \mid n$,则$\varphi ( n ) = \varphi ( \frac{n}{p} ) \times p$.</p>
</li>
<li><p>$p$为质数,若$p \mid n$且$p^{2} \not \mid n$,则$\varphi ( n ) = \varphi ( \frac{n}{p} ) \times (p-1)$.</p>
</li>
</ol>
<h2 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h2><h3 id="分解质因数求法"><a href="#分解质因数求法" class="headerlink" title="分解质因数求法"></a>分解质因数求法</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">temp=phi=m;</span><br><span class="line"><span class="keyword">for</span>(R lxl i=<span class="number">2</span>;i*i&lt;=m;++i)</span><br><span class="line">&#123;	</span><br><span class="line">	<span class="keyword">if</span>(!(temp%i))</span><br><span class="line">	&#123;</span><br><span class="line">		phi=phi-phi/i;</span><br><span class="line">		<span class="keyword">while</span>(temp%i==<span class="number">0</span>)temp/=i;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(temp&gt;<span class="number">1</span>)phi=phi-phi/temp;</span><br></pre></td></tr></table></figure>
<h3 id="线性筛求法"><a href="#线性筛求法" class="headerlink" title="线性筛求法"></a>线性筛求法</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(R lxl i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span>(!v[i])prime[++cnt]=i,v[i]=i;</span><br><span class="line">	<span class="keyword">for</span>(R lxl j=<span class="number">1</span>;j&lt;=cnt;++j)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(v[i]&lt;prime[j]||prime[j]*i&gt;n)<span class="keyword">break</span>;</span><br><span class="line">		v[i*prime[j]]=prime[j];</span><br><span class="line">		phi[i*prime[j]]=pri[i]*(i%prime[j]?prime[j]<span class="number">-1</span>:prime[j]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="乘法逆元"><a href="#乘法逆元" class="headerlink" title="乘法逆元"></a>乘法逆元</h1><h2 id="思想-3"><a href="#思想-3" class="headerlink" title="思想"></a>思想</h2><p>若$a \times x \equiv 1 ( mod  b )$,则称$x$为$a$模$b$意义下的乘法逆元,记为$a^{-1}$.</p>
<p>根据乘法逆元的定义,可以通过费马定理求出乘法逆元.</p>
<p>费马定理的形式是:若$a$与$p$互质,则$a^{p-1} \equiv 1 ( mod  p )$.</p>
<p>进行变形,得出$a^{p-2} \times a \equiv 1 ( mod  p)$,所以说$a^{p-2}$就是$a$的乘法逆元,用快速幂求出即可.</p>
<p>很明显该方法在$a$与$p$不互质的情况下是错误的.</p>
<p>逆元还有一种线性求法,证明过程如下:</p>
<p>$1^{-1} \equiv 1  ( mod  p)$</p>
<p>设$p = k \times i + r$,$r &lt; i$,$1 &lt; i &lt; p$,得到:</p>
<p>$ k \times i + r \equiv 0  ( mod  p)$</p>
<p>根据同余的同乘性,两边乘上$i^{-1}$,$r^{-1}$,得:</p>
<p>$k \times r^{-1}+ i^{-1} \equiv 0 \qquad ( mod  p)$</p>
<p>$\Rightarrow i^{-1} \equiv -k \times r^{-1} \qquad ( mod  p)$</p>
<p>$\Rightarrow i^{-1} \equiv - \frac{p}{i} \times ( p  mod  i)^{-1} \qquad ( mod  p)$</p>
<p>所以说就可以递推求出逆元了,代码极其简单.</p>
<p>通过这个思路也可以递归求出单个数的逆元,递归求$(p  mod  i)$即可.</p>
<p>至于乘法逆元有什么用,对于$\frac{a}{b} mod  p$,只需求出$b$在模$p$意义下的乘法逆元,然后乘上$a$,再$mod  p$,就是这个分数的值了.</p>
<h2 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h2><h3 id="费马定理求法"><a href="#费马定理求法" class="headerlink" title="费马定理求法"></a>费马定理求法</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> lxl <span class="title">ksm</span><span class="params">(lxl a,lxl b,lxl p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	lxl base=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(;b;b&gt;&gt;=<span class="number">1</span>,a=a*a%p)<span class="keyword">if</span>(b&amp;<span class="number">1</span>)base=base*a%p;</span><br><span class="line">	<span class="keyword">return</span> base;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="线性求法"><a href="#线性求法" class="headerlink" title="线性求法"></a>线性求法</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">inv[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(R lxl i=<span class="number">2</span>;i&lt;=n;++i)inv[i]=(p-p/i)*inv[p%i]%p;</span><br></pre></td></tr></table></figure>
<h1 id="欧拉定理"><a href="#欧拉定理" class="headerlink" title="欧拉定理"></a>欧拉定理</h1><h2 id="思想-4"><a href="#思想-4" class="headerlink" title="思想"></a>思想</h2><p>$<br>a^{b} =<br>\begin{equation}<br>\left\{<br>\begin{array}{r}<br>    a^{b  mod  \varphi ( p )} \qquad ( a , p ) = 1 \\<br>    a^{b  mod  \varphi ( p ) + \varphi ( p )} \qquad b \geq \varphi ( p ) \\<br>    a^{b} \qquad b &lt; \varphi ( p )<br>\end{array}<br>\right.<br>\end{equation}<br>$</p>
<p>至于这个定理有什么用,目前我所知的就是解这道丧心病狂的题.</p>
<blockquote>
<p>求$ a^{n}  mod  m,1 \leq a \leq 10^{9},1 \leq b \leq 10^{20000000<br> },1 \leq m \leq 10^{8}.$</p>
</blockquote>
<h2 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cctype"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"map"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"vector"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"queue"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stack"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> i _</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> j __</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) printf(<span class="meta-string">"debug:%lld"</span>,x) </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n,m,b,phi,temp;</span><br><span class="line"><span class="keyword">bool</span> falg;</span><br><span class="line"><span class="keyword">char</span> c;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> lxl <span class="title">ksm</span><span class="params">(lxl a,lxl b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	lxl base=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(;b;b&gt;&gt;=<span class="number">1</span>,a=a*a%m)</span><br><span class="line">		<span class="keyword">if</span>(b&amp;<span class="number">1</span>)base=base*a%m;</span><br><span class="line">	<span class="keyword">return</span> base;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;n,&amp;m);</span><br><span class="line">	temp=phi=m;</span><br><span class="line">	<span class="keyword">for</span>(R lxl i=<span class="number">2</span>;i*i&lt;=m;++i)</span><br><span class="line">	&#123;	</span><br><span class="line">		<span class="keyword">if</span>(!(temp%i))</span><br><span class="line">		&#123;</span><br><span class="line">			phi=phi-phi/i;</span><br><span class="line">			<span class="keyword">while</span>(temp%i==<span class="number">0</span>)temp/=i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(temp&gt;<span class="number">1</span>)phi=phi-phi/temp;</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c=getchar()));</span><br><span class="line">    <span class="keyword">for</span>(;<span class="built_in">isdigit</span>(c);c=getchar())</span><br><span class="line">	&#123;</span><br><span class="line">		b=b*<span class="number">10</span>+c-<span class="string">'0'</span>;</span><br><span class="line">		<span class="keyword">if</span>(b&gt;=phi)</span><br><span class="line">		&#123;</span><br><span class="line">			b=b%phi;</span><br><span class="line">			falg=<span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(falg)</span><br><span class="line">	&#123;</span><br><span class="line">		b+=phi;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ksm(n,b));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      </div>
      <div class="post-copyright">
    <p class="copyright-item">
      <span>Author: </span>
      <a href="https://www.lemir3.red">lemir3</a>
    </p>
    <p class="copyright-item">
      <span>Link: </span>
      <a href="https://www.lemir3.red/2019/10/20/csps2019-fu-xi-te-bie-xiang-mu-shu-lun-mo-ban/">https://www.lemir3.red/2019/10/20/csps2019-fu-xi-te-bie-xiang-mu-shu-lun-mo-ban/</a>
    </p>
    <p class="copyright-item">
      <span>License: </span><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>
    </p>
  </div>
      <footer class="post-footer">
        <div class="post-tags">
            <a href="/tags/数论/">数论</a>
            <a href="/tags/总结/">总结</a>
            </div>
        
        <nav class="post-nav"><a class="prev" href="/2019/10/23/project1441-fa-ma-cheng-chong-xiang-mu-bao-gao/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Project1441砝码称重项目报告</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    <a class="next" href="/2019/10/11/project1850-huan-jiao-shi-gong-zuo-bao-gao/">
        <span class="next-text nav-default">Project1850换教室工作报告</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></footer>
    </article></div><div class="comments" id="comments"><div id="gitalk-container"></div>
    </div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:lemir3@outlook.com" class="iconfont icon-email" title="email"></a>
        <a href="https://github.com/lemir3" class="iconfont icon-github" title="github"></a>
        <a href="https://www.zhihu.com/people/lemir3" class="iconfont icon-zhihu" title="zhihu"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2019 - 2020<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">lemir3</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>


<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">


<script src="//cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js"></script>

<script>
  var gitalk = new Gitalk({
    clientID: '670bf3ed0a83fdca6808',
    clientSecret: '9ea030854681b4438efa115f56dfe069f38f33d3',
    repo: 'lemir3.github.io',
    owner: 'lemir3',
    admin: ['lemir3'],
    id: md5(location.pathname),
    
      language: 'en',
    
    distractionFreeMode: 'true'
  });
  gitalk.render('gitalk-container');
</script><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
<link rel="stylesheet" href="\css\APlayer.min.css">
  <script src="\js\APlayer.min.js"></script>
  <div id="aplayer" class="aplayer" data-id="3220766973" data-server="netease" data-type="playlist" data-fixed="true" data-listfolded="true" data-order="random" data-theme="#ff0000b3"></div>
  <script src="\js\Meting.min.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
  </body>
</html>
