<!DOCTYPE html>
<html lang="zh-CN">
  <head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8">
<!-- hexo-inject:begin --><!-- hexo-inject:end --><meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="炮打DP运动总结"><meta name="keywords" content="动态规划, Lemir3's blog"><link rel="alternate" href="/atom.xml" title="Lemir3's blog"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0">
<link rel="canonical" href="https://www.lemir3.red/2019/08/31/pao-da-dp-yun-dong-zong-jie/">

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css"><script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0">

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":"","latex":true};
</script>

    <title>炮打DP运动总结 - Lemir3's blog</title>
  <link rel="alternate" href="/atom.xml" title="Lemir3's blog" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="mobile-header-logo">
    <a href="/." class="logo">Lemir3's blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">Home
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">Archives
          </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags
          </li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories
          </li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About
          </li>
      </a><a href="/links/">
        <li class="mobile-menu-item">Links
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Lemir3's blog</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            Home
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            Archives
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            Tags
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/categories/">
            Categories
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about/">
            About
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/links/">
            Links
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><article class="post">
    <header class="post-header">
      <h1 class="post-title">炮打DP运动总结
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2019-08-31
        </span><span class="post-category">
            <a href="/categories/动态规划/">动态规划</a>
            </span>
        </div>
    </header>

    <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">Contents</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#什么是DP"><span class="toc-text">什么是DP?</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#怎样判定DP"><span class="toc-text">怎样判定DP?</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DP的三个要素"><span class="toc-text">DP的三个要素</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#线性DP"><span class="toc-text">线性DP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#LIS"><span class="toc-text">LIS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#O-n-2-做法"><span class="toc-text">$O$($n^2$)做法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码1"><span class="toc-text">代码1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#O-nlogn-做法"><span class="toc-text">$O$($nlogn$)做法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码2"><span class="toc-text">代码2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LCS"><span class="toc-text">LCS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#O-n-2-做法-1"><span class="toc-text">$O$($n^2$)做法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码1-1"><span class="toc-text">代码1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#O-nlogn-做法-1"><span class="toc-text">$O$($nlogn$)做法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码2-1"><span class="toc-text">代码2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LCIS"><span class="toc-text">LCIS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#O-n-3-做法"><span class="toc-text">$O$($n^3$)做法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码1-2"><span class="toc-text">代码1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#O-n-2-做法-2"><span class="toc-text">$O$($n^2$)做法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码2-2"><span class="toc-text">代码2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#垂线法"><span class="toc-text">垂线法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#方法讲解"><span class="toc-text">方法讲解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码-P1169-ZJOI2007-棋盘制作"><span class="toc-text">代码(P1169 [ZJOI2007]棋盘制作)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P1736-创意吃鱼法"><span class="toc-text">P1736 创意吃鱼法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P1006-传纸条"><span class="toc-text">P1006 传纸条</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目分析"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码"><span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P1373-小a和uim之大逃离"><span class="toc-text">P1373 小a和uim之大逃离</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目分析-1"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码-1"><span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P2389-电脑班的裁员"><span class="toc-text">P2389 电脑班的裁员</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目分析-2"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码-2"><span class="toc-text">代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#区间DP"><span class="toc-text">区间DP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#P1220-关路灯"><span class="toc-text">P1220 关路灯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P1005-矩阵取数游戏"><span class="toc-text">P1005 矩阵取数游戏</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目分析-3"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码-3"><span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P4170-CQOI2007-涂色"><span class="toc-text">P4170 [CQOI2007]涂色</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目分析-4"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码-4"><span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P3205-HNOI2010-合唱队"><span class="toc-text">P3205 [HNOI2010]合唱队</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目分析-5"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码-5"><span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P4302-SCOI2003-字符串折叠"><span class="toc-text">P4302 [SCOI2003]字符串折叠</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目分析-6"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码-6"><span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P2470-SCOI2007-压缩"><span class="toc-text">P2470 [SCOI2007]压缩</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目分析-7"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码-7"><span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P3004-USACO10DEC-宝箱Treasure-Chest-amp-P2734-游戏-A-Game"><span class="toc-text">P3004 [USACO10DEC]宝箱Treasure Chest &amp; P2734 游戏 A Game</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目分析-8"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码-8"><span class="toc-text">代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#树形DP"><span class="toc-text">树形DP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#P1273-有线电视网"><span class="toc-text">P1273 有线电视网</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目分析-9"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码-9"><span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P1272-重建道路"><span class="toc-text">P1272 重建道路</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目分析-10"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码-10"><span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P3267-JLOI2016-SHOI2016-侦察守卫"><span class="toc-text">P3267 [JLOI2016/SHOI2016]侦察守卫</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目分析-11"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码-11"><span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P2796-Facer的程序"><span class="toc-text">P2796 Facer的程序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#题目分析-12"><span class="toc-text">题目分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#代码-12"><span class="toc-text">代码</span></a></li></ol></li></ol></li></ol>
    </div>
  </div><div class="post-content"><p>摘要:提高组范围内的$DP$总结(因为开学了,目前仍在更新)</p>
<a id="more"></a>
<h1 id="什么是DP"><a href="#什么是DP" class="headerlink" title="什么是DP?"></a>什么是DP?</h1><p><em>以下内容摘自《算法竞赛进阶指南》</em></p>
<blockquote>
<p>动态规划算法针对满足特定条件的一类问题,对各状态维度进行分阶段、有顺序、无重复、决策性的遍历求解。</p>
</blockquote>
<h1 id="怎样判定DP"><a href="#怎样判定DP" class="headerlink" title="怎样判定DP?"></a>怎样判定DP?</h1><p>一般来说,$DP$满足以下两个基本性质:</p>
<ul>
<li><p>最优子结构:任意一个问题的最优解一定是由其子问题的最优解构成的.</p>
</li>
<li><p>无后效性:问题的求解过程构成一张$DAG$图,无论后面的问题怎样求解,也不会影响到前面已经求解出的问题.</p>
</li>
</ul>
<p>满足以上性质的问题就可以使用$DP$解决.</p>
<h1 id="DP的三个要素"><a href="#DP的三个要素" class="headerlink" title="DP的三个要素"></a>DP的三个要素</h1><p>$DP$有三个要素,即:</p>
<ul>
<li><p>阶段</p>
</li>
<li><p>状态</p>
</li>
<li><p>决策</p>
</li>
</ul>
<p>阶段即问题求解到了哪一步,比如在区间$DP$问题中,阶段即区间的长度,在线性$DP$中,阶段一般与状态重合.</p>
<p>状态即问题的子问题,数组下标为对这个子问题的描述,值为这个子问题的解.</p>
<p>决策即状态间转移的方式.</p>
<h1 id="线性DP"><a href="#线性DP" class="headerlink" title="线性DP"></a>线性DP</h1><h2 id="LIS"><a href="#LIS" class="headerlink" title="LIS"></a>LIS</h2><blockquote>
<p>给定一个长度为$n$的序列,求这个序列的最长上升子序列的长度.</p>
</blockquote>
<p><a href="https://www.luogu.org/problem/AT2827" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="O-n-2-做法"><a href="#O-n-2-做法" class="headerlink" title="$O$($n^2$)做法"></a>$O$($n^2$)做法</h3><p>首先同志们设计状态$f_i$,表示以$i$位置结尾的$LIS$的长度.</p>
<p>再来考虑决策,一个位置的$LIS$长度,可由它前面比它小的点的$LIS$转移得到,于是可以用一个$O$($n^2$)的循环解决问题.</p>
<p>目标为$f_n$.</p>
<h3 id="代码1"><a href="#代码1" class="headerlink" title="代码1"></a>代码1</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(R lxl __=<span class="number">1</span>;__&lt;=_;++__)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(num[_]&gt;num[__])</span><br><span class="line">        &#123;</span><br><span class="line">            f[_]=max(f[_],f[__]+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="O-nlogn-做法"><a href="#O-nlogn-做法" class="headerlink" title="$O$($nlogn$)做法"></a>$O$($nlogn$)做法</h3><p>这个问题有一个$O$($nlogn$)的优化.</p>
<p>同志们可以用一个数组$d$记录每个长度的$LIS$的最小末尾,”最小”以保证后面有更多的数能够进来.</p>
<p>很容易知道这个数组是单调递增的.</p>
<p>如果当前这个数大于数组$d$的最后一位,那么就把这个数加入到$d$数组中.</p>
<p>如果这个数小于数组$d$的最后一位,因为$d$数组是单调递增的,所以同志们可以二分出大于等于这个数的第一个位置,把这个位置上的数换成这个数,意为长度为这个位置的最小末尾可以更新为当前这个数,这样就可以确保有更多的数能够被算进来.</p>
<p>最后答案就为$d$数组的长度.</p>
<h3 id="代码2"><a href="#代码2" class="headerlink" title="代码2"></a>代码2</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(num[_]&gt;d[len])</span><br><span class="line">    &#123;</span><br><span class="line">        d[++len]=num[_];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        lxl k=lower_bound(d+<span class="number">1</span>,d+<span class="number">1</span>+len,num[_])-d;</span><br><span class="line">        d[k]=min(d[k],num[_]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="LCS"><a href="#LCS" class="headerlink" title="LCS"></a>LCS</h2><blockquote>
<p>给定两个长度分别为$N$和$M$的字符串$A$和$B$,求既是$A$的子序列又是$B$的子序列的字符串最长长度.</p>
</blockquote>
<p><a href="https://www.luogu.org/problem/P1439" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="O-n-2-做法-1"><a href="#O-n-2-做法-1" class="headerlink" title="$O$($n^2$)做法"></a>$O$($n^2$)做法</h3><p>设计状态$f_{i,j}$表示前缀子串$A_{1~i}$与$B_{1~j}$的$LCS$的长度.</p>
<p>阶段既是两个字符串中对应的位置.</p>
<p>考虑决策,对于一个状态$f_{i,j}$,如果$A_i$等于$B_j$的话,它可以由$f_{i-1,j-1}$转移而来,再加上当前阶段的$1$.另外的,对于每一个状态,都可以从$f_{i-1,j}$和$f_{i,j-1}$转移而来.</p>
<p>目标为$f_{n,m}$.</p>
<h3 id="代码1-1"><a href="#代码1-1" class="headerlink" title="代码1"></a>代码1</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(R lxl __=<span class="number">1</span>;__&lt;=m;++__)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[_]==b[__])</span><br><span class="line">        &#123;</span><br><span class="line">            f[_][__]=max(f[_][__],f[_<span class="number">-1</span>][__<span class="number">-1</span>]+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        f[_][__]=max(f[_][__],max(f[_<span class="number">-1</span>][__],f[_][__<span class="number">-1</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="O-nlogn-做法-1"><a href="#O-nlogn-做法-1" class="headerlink" title="$O$($nlogn$)做法"></a>$O$($nlogn$)做法</h3><p>这个问题同样有一个$O$($nlogn$)的优化.</p>
<p>用一个$map$映射出$B$中的每一个数在$A$中的位置,可以发现,如果这个对应的位置中有子序列是单调递增的,就说明这几个$B$中的元素可以连续对应到$A$中去,这时候只要求出这个对应位置数组的$LIS$,就可以求出原来两个序列的$LCS$了.</p>
<p>求$LIS$的过程可以用上面的$O$($nlogn$)方法.</p>
<h3 id="代码2-1"><a href="#代码2-1" class="headerlink" title="代码2"></a>代码2</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;s1[_];</span><br><span class="line">    map_[s1[_]]=_;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;s2[_];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(map_[s2[_]]&gt;dp[len])</span><br><span class="line">    &#123;</span><br><span class="line">       dp[++len]=map_[s2[_]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">       &#123;</span><br><span class="line">       lxl k=lower_bound(dp+<span class="number">1</span>,dp+<span class="number">1</span>+len,map_[s2[_]])-dp;</span><br><span class="line">       dp[k]=min(dp[k],map_[s2[_]]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="LCIS"><a href="#LCIS" class="headerlink" title="LCIS"></a>LCIS</h2><blockquote>
<p>求两个串的最长公共上升子序列.</p>
</blockquote>
<p>前面两个问题的综合.</p>
<p><a href="https://www.luogu.org/problem/CF10D" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="O-n-3-做法"><a href="#O-n-3-做法" class="headerlink" title="$O$($n^3$)做法"></a>$O$($n^3$)做法</h3><p>把前面两个问题结合一下,不难想出$O$($n^3$)的做法.</p>
<p>设状态$f_{i,j}$表示$a_{1 \to i}$与$b_{1 \to j}$中以$b_j$结尾的$LCIS$长度.</p>
<p>阶段为$i$.</p>
<p>当$a_i \neq b_j$时,该状态由$f_{i-1,j}$转移而来.</p>
<p>当$a_i = b_j$时,该状态由$f_{i-1,k} (0 \leq k &lt; j,b_k &lt; b_j,b_k &lt; a_i)$转移而来.</p>
<p>目标为$max(f_{n,1 \to m})$.</p>
<h3 id="代码1-2"><a href="#代码1-2" class="headerlink" title="代码1"></a>代码1</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(R lxl __=<span class="number">1</span>;__&lt;=m;++__)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[_]==b[__])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(R lxl ___=<span class="number">0</span>;___&lt;=__;++___)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(b[___]&lt;a[_])</span><br><span class="line">                &#123;</span><br><span class="line">                    f[_][__]=max(f[_][__],f[_<span class="number">-1</span>][___]+<span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            f[_][__]=f[_<span class="number">-1</span>][__];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="O-n-2-做法-2"><a href="#O-n-2-做法-2" class="headerlink" title="$O$($n^2$)做法"></a>$O$($n^2$)做法</h3><p>可以发现的是,上面的做法重复寻找了多次最大的$f_{i-1,k}$来做出决策.</p>
<p>在每个阶段中,同志们把满足$0 \leq k &lt; j,b_k &lt; a_i$的$k$称为$f_{i,j}$的决策集合,可以注意到,在第二重循环里面,$i$的值是固定的,也就使得之前已经得出的决策集合里的$b_k &lt; a_i$是固定的,然而每次的第三重循环都重复地把这些决策枚举了一遍.</p>
<p>对于这种决策集合只增大不减小的情况,同志们可以直接用一个变量来记录决策集合里最优的决策,每次更新这个变量即可<del>科技为了我</del>.</p>
<p>这样就省去了第三维.</p>
<h3 id="代码2-2"><a href="#代码2-2" class="headerlink" title="代码2"></a>代码2</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">&#123;</span><br><span class="line">    lxl val=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(b[<span class="number">0</span>]&lt;a[i])</span><br><span class="line">    &#123;</span><br><span class="line">        val=f[i<span class="number">-1</span>][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl __=<span class="number">1</span>;__&lt;=m;++__)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[_]==b[__])</span><br><span class="line">        &#123;</span><br><span class="line">            f[_][__]=val+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            f[_][__]=f[_<span class="number">-1</span>][__];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(b[__]&lt;a[_])</span><br><span class="line">        &#123;</span><br><span class="line">            val=max(val,f[_<span class="number">-1</span>][__]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="垂线法"><a href="#垂线法" class="headerlink" title="垂线法"></a>垂线法</h2><h3 id="方法讲解"><a href="#方法讲解" class="headerlink" title="方法讲解"></a>方法讲解</h3><p><a href="https://blog.csdn.net/clover_hxy/article/details/50532289?locationNum=1&amp;fps=1" target="_blank" rel="noopener"><em>可以看这篇垂线法的国家集训队论文</em></a></p>
<p>问题一般是求解各种奇奇怪怪的子矩阵.</p>
<p><a href="https://www.luogu.org/problem/P1169" target="_blank" rel="noopener"><em>题目1</em></a></p>
<p><a href="https://www.luogu.org/problem/P1169" target="_blank" rel="noopener"><em>题目2</em></a></p>
<p>简单来说就是处理出每个位置向上左右三个方向扩展的最大长度,然后扫描一遍求出这些位置上的最大子矩阵即可<del>科技为了我</del>.</p>
<p>注意在计算子矩阵面积的时候,要和上一层向左向右的扩展的最大长度取最小值.</p>
<p>然后就没什么可说的了,上代码呗……</p>
<h3 id="代码-P1169-ZJOI2007-棋盘制作"><a href="#代码-P1169-ZJOI2007-棋盘制作" class="headerlink" title="代码(P1169 [ZJOI2007]棋盘制作)"></a>代码(P1169 [ZJOI2007]棋盘制作)</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;<span class="meta-string">"\n"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n,m,ans1=-INF,ans2=-INF;</span><br><span class="line">lxl chess[<span class="number">3010</span>][<span class="number">3010</span>],left_[<span class="number">3010</span>][<span class="number">3010</span>],right_[<span class="number">3010</span>][<span class="number">3010</span>],up[<span class="number">3010</span>][<span class="number">3010</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl __=<span class="number">1</span>;__&lt;=m;++__)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cin</span>&gt;&gt;chess[_][__];</span><br><span class="line">            left_[_][__]=__;</span><br><span class="line">            right_[_][__]=__;</span><br><span class="line">            up[_][__]=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl __=<span class="number">2</span>;__&lt;=m;++__)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(chess[_][__]!=chess[_][__<span class="number">-1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                left_[_][__]=left_[_][__<span class="number">-1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl __=m<span class="number">-1</span>;__&gt;=<span class="number">1</span>;--__)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(chess[_][__]!=chess[_][__+<span class="number">1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                right_[_][__]=right_[_][__+<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl __=<span class="number">1</span>;__&lt;=m;++__)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(_&gt;=<span class="number">2</span>&amp;&amp;chess[_][__]!=chess[_<span class="number">-1</span>][__])</span><br><span class="line">            &#123;</span><br><span class="line">                left_[_][__]=max(left_[_][__],left_[_<span class="number">-1</span>][__]);</span><br><span class="line">                right_[_][__]=min(right_[_][__],right_[_<span class="number">-1</span>][__]);</span><br><span class="line">                up[_][__]=up[_<span class="number">-1</span>][__]+<span class="number">1</span>;</span><br><span class="line">            &#125;   </span><br><span class="line">            lxl a=right_[_][__]-left_[_][__]+<span class="number">1</span>;</span><br><span class="line">            lxl b=min(a,up[_][__]);</span><br><span class="line">            ans1=max(ans1,b*b);</span><br><span class="line">            ans2=max(ans2,a*up[_][__]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans1&lt;&lt;<span class="string">"\n"</span>&lt;&lt;ans2&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="P1736-创意吃鱼法"><a href="#P1736-创意吃鱼法" class="headerlink" title="P1736 创意吃鱼法"></a>P1736 创意吃鱼法</h2><p><a href="https://www.lemir3.red/2019/08/28/红星拖拉机厂Project1736_创意吃鱼法项目报告/"><em>直接看我的这篇博客呗</em></a></p>
<h2 id="P1006-传纸条"><a href="#P1006-传纸条" class="headerlink" title="P1006 传纸条"></a>P1006 传纸条</h2><p><a href="https://www.luogu.org/problem/P1006" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="题目分析"><a href="#题目分析" class="headerlink" title="题目分析"></a>题目分析</h3><p>定义状态$f_{i,x_1,x_2}$,表示步长为$i$时,第一条路径的末尾横坐标和第二条路径的末尾横坐标.</p>
<p>因为很容易导出$x_1 + y_1 = x_2 + y_2 = i + 2$,容易用这三维就可以描述一个状态.</p>
<p>之后的就十分简单了,状态转移方程直接看代码就可以懂了,直接上代码.</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cctype"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;<span class="meta-string">"\n"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n,m;</span><br><span class="line">lxl val[<span class="number">51</span>][<span class="number">51</span>],dp[<span class="number">110</span>][<span class="number">51</span>][<span class="number">51</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl __=<span class="number">1</span>;__&lt;=m;++__)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cin</span>&gt;&gt;val[_][__];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">1</span>][<span class="number">1</span>]=val[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">0</span>;_&lt;=n+m<span class="number">-2</span>;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl x1=<span class="number">1</span>;x1&lt;=min(_+<span class="number">1</span>,n);++x1)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(R lxl x2=<span class="number">1</span>;x2&lt;=min(_+<span class="number">1</span>,n);++x2)</span><br><span class="line">            &#123;</span><br><span class="line">                lxl y1=_+<span class="number">2</span>-x1;</span><br><span class="line">                lxl y2=_+<span class="number">2</span>-x2;</span><br><span class="line">                <span class="keyword">if</span>(x1==x2&amp;&amp;y1+<span class="number">1</span>==y2+<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dp[_+<span class="number">1</span>][x1][x2]=max(dp[_+<span class="number">1</span>][x1][x2],dp[_][x1][x2]+val[x1][y1+<span class="number">1</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    dp[_+<span class="number">1</span>][x1][x2]=max(dp[_+<span class="number">1</span>][x1][x2],dp[_][x1][x2]+val[x1][y1+<span class="number">1</span>]+val[x2][y2+<span class="number">1</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(x1+<span class="number">1</span>==x2+<span class="number">1</span>&amp;&amp;y1==y2)</span><br><span class="line">                &#123;</span><br><span class="line">                    dp[_+<span class="number">1</span>][x1+<span class="number">1</span>][x2+<span class="number">1</span>]=max(dp[_+<span class="number">1</span>][x1+<span class="number">1</span>][x2+<span class="number">1</span>],dp[_][x1][x2]+val[x1+<span class="number">1</span>][y1]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    dp[_+<span class="number">1</span>][x1+<span class="number">1</span>][x2+<span class="number">1</span>]=max(dp[_+<span class="number">1</span>][x1+<span class="number">1</span>][x2+<span class="number">1</span>],dp[_][x1][x2]+val[x1+<span class="number">1</span>][y1]+val[x2+<span class="number">1</span>][y2]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(x1+<span class="number">1</span>==x2&amp;&amp;y1==y2+<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dp[_+<span class="number">1</span>][x1+<span class="number">1</span>][x2]=max(dp[_+<span class="number">1</span>][x1+<span class="number">1</span>][x2],dp[_][x1][x2]+val[x1+<span class="number">1</span>][y1]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    dp[_+<span class="number">1</span>][x1+<span class="number">1</span>][x2]=max(dp[_+<span class="number">1</span>][x1+<span class="number">1</span>][x2],dp[_][x1][x2]+val[x1+<span class="number">1</span>][y1]+val[x2][y2+<span class="number">1</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(x1==x2+<span class="number">1</span>&amp;&amp;y1+<span class="number">1</span>==y2)</span><br><span class="line">                &#123;</span><br><span class="line">                    dp[_+<span class="number">1</span>][x1][x2+<span class="number">1</span>]=max(dp[_+<span class="number">1</span>][x1][x2+<span class="number">1</span>],dp[_][x1][x2]+val[x1][y1+<span class="number">1</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    dp[_+<span class="number">1</span>][x1][x2+<span class="number">1</span>]=max(dp[_+<span class="number">1</span>][x1][x2+<span class="number">1</span>],dp[_][x1][x2]+val[x1][y1+<span class="number">1</span>]+val[x2+<span class="number">1</span>][y2]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;dp[n+m<span class="number">-2</span>][n][n]&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="P1373-小a和uim之大逃离"><a href="#P1373-小a和uim之大逃离" class="headerlink" title="P1373 小a和uim之大逃离"></a>P1373 小a和uim之大逃离</h2><p><a href="https://www.luogu.org/problem/P1373" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="题目分析-1"><a href="#题目分析-1" class="headerlink" title="题目分析"></a>题目分析</h3><p>设计状态为$f_{i,j,k,opt}$,表示位置在($i,j$)时,两人魔液的差值为$k$,上一步是由$opt$取的魔液.</p>
<p>每个状态由上方或左方转移而来,如果是上一步是第一个人取的话,这次由第二个人取,魔液的差值变小,如果是上一步第二个人取的话,这次由第一个人取,魔液的差值变大.</p>
<p>最后答案为每个$k$为$0$,$opt$为$1$的状态的值累加.</p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 21467483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n,m,k;</span><br><span class="line">lxl ans;</span><br><span class="line"><span class="keyword">int</span> dp[<span class="number">810</span>][<span class="number">810</span>][<span class="number">20</span>][<span class="number">2</span>],a[<span class="number">810</span>][<span class="number">810</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m&gt;&gt;k;</span><br><span class="line">    k++;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl __=<span class="number">1</span>;__&lt;=m;++__)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cin</span>&gt;&gt;a[_][__];</span><br><span class="line">            dp[_][__][a[_][__]%k][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl __=<span class="number">1</span>;__&lt;=m;++__)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(R lxl ___=<span class="number">0</span>;___&lt;=k;++___)</span><br><span class="line">            &#123;</span><br><span class="line">                dp[_][__][___][<span class="number">0</span>]+=(dp[_<span class="number">-1</span>][__][(___-a[_][__]+k)%k][<span class="number">1</span>])%mod;</span><br><span class="line">                dp[_][__][___][<span class="number">0</span>]+=(dp[_][__<span class="number">-1</span>][(___-a[_][__]+k)%k][<span class="number">1</span>])%mod;</span><br><span class="line">                dp[_][__][___][<span class="number">1</span>]+=(dp[_<span class="number">-1</span>][__][(___+a[_][__]+k)%k][<span class="number">0</span>])%mod;</span><br><span class="line">                dp[_][__][___][<span class="number">1</span>]+=(dp[_][__<span class="number">-1</span>][(___+a[_][__]+k)%k][<span class="number">0</span>])%mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl __=<span class="number">1</span>;__&lt;=m;++__)</span><br><span class="line">        &#123;</span><br><span class="line">            ans=(ans+dp[_][__][<span class="number">0</span>][<span class="number">1</span>])%mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="P2389-电脑班的裁员"><a href="#P2389-电脑班的裁员" class="headerlink" title="P2389 电脑班的裁员"></a>P2389 电脑班的裁员</h2><p><a href="https://www.luogu.org/problem/P2389" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="题目分析-2"><a href="#题目分析-2" class="headerlink" title="题目分析"></a>题目分析</h3><p>定义状态$f_{i,j,opt}$,表示选了前面$i$个数,选了$j$段,当前这个人选不选的最优解.</p>
<p>对于选的情况,可以由两种状态转移来,分别是:</p>
<ul>
<li><p>$dp_{i-1,j,1}$,表示前一个数要选.</p>
</li>
<li><p>$dp_{i-1,j-1,0}$,表示前一个数不选,这个段是新开始的段.</p>
</li>
</ul>
<p>然后加上这个位置的分数.</p>
<p>不选的情况就很简单了,由$max(dp_{i-1,j,1},dp_{i-1,j,0})$转移而来即可<del>科技为了我</del>.</p>
<h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cctype"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;<span class="meta-string">"\n"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n,k,ans=-INF;</span><br><span class="line">lxl score[<span class="number">510</span>],dp[<span class="number">510</span>][<span class="number">510</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;score[_];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl __=<span class="number">1</span>;__&lt;=k;++__)</span><br><span class="line">        &#123;</span><br><span class="line">            dp[_][__][<span class="number">1</span>]=max(dp[_<span class="number">-1</span>][__][<span class="number">1</span>],dp[_<span class="number">-1</span>][__<span class="number">-1</span>][<span class="number">0</span>])+score[_];</span><br><span class="line">            dp[_][__][<span class="number">0</span>]=max(dp[_<span class="number">-1</span>][__][<span class="number">1</span>],dp[_<span class="number">-1</span>][__][<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=k;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        ans=max(dp[n][_][<span class="number">0</span>],dp[n][_][<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="区间DP"><a href="#区间DP" class="headerlink" title="区间DP"></a>区间DP</h1><p>阶段为区间长度,子问题划分为区间的一种$DP$.</p>
<h2 id="P1220-关路灯"><a href="#P1220-关路灯" class="headerlink" title="P1220 关路灯"></a>P1220 关路灯</h2><p><a href="https://www.lemir3.red/2019/08/18/P1220老张同志关路灯的难题被顺利解决/"><em>直接看我的这篇博客呗</em></a></p>
<h2 id="P1005-矩阵取数游戏"><a href="#P1005-矩阵取数游戏" class="headerlink" title="P1005 矩阵取数游戏"></a>P1005 矩阵取数游戏</h2><p><a href="https://www.luogu.org/problem/P1005" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="题目分析-3"><a href="#题目分析-3" class="headerlink" title="题目分析"></a>题目分析</h3><p>其实这题很水.</p>
<p>定义状态$f_{l,r}$表示起点为$l$,终点为$r$的区间的最优解.</p>
<p>用一个两维的循环,一维从前往后枚举区间的起点,一维从后往前枚举区间的终点,从区间的左端点和右端点转移就行了.</p>
<p>目标为所有长度为$1$的区间加上这个位置的数的最大值.</p>
<p>注意要用高精.</p>
<p><a href="https://www.lemir3.red/2019/09/06/即可科技大学永动机系压位高精技术取得突破性进展/"><em>压位高精讲解</em></a></p>
<h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 10000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n,m;</span><br><span class="line">lxl a[<span class="number">85</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">Hp</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    lxl p[<span class="number">510</span>],len;</span><br><span class="line"></span><br><span class="line">    _Hp()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(p,<span class="number">0</span>,<span class="keyword">sizeof</span>(p));</span><br><span class="line">        len=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;p[len];</span><br><span class="line">        <span class="keyword">for</span>(R lxl _=len<span class="number">-1</span>;_&gt;<span class="number">0</span>;--_)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(p[_]==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">cout</span>&lt;&lt;<span class="string">"0000"</span>;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(R lxl k=<span class="number">10</span>;k*p[_]&lt;mod;k*=<span class="number">10</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">cout</span>&lt;&lt;<span class="string">"0"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;p[_];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;dp[<span class="number">85</span>][<span class="number">85</span>],base[<span class="number">85</span>],ans;</span><br><span class="line"></span><br><span class="line">_Hp <span class="keyword">operator</span> +(<span class="keyword">const</span> _Hp &amp;a,<span class="keyword">const</span> _Hp &amp;b)</span><br><span class="line">&#123;</span><br><span class="line">    _Hp c;</span><br><span class="line">    c.len=max(a.len,b.len);</span><br><span class="line">    lxl x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=c.len;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        c.p[_]=a.p[_]+b.p[_]+x;</span><br><span class="line">        x=c.p[_]/mod;</span><br><span class="line">        c.p[_]%=mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        c.p[++c.len]=x;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">_Hp <span class="keyword">operator</span> *(<span class="keyword">const</span> _Hp &amp;a,<span class="keyword">const</span> lxl &amp;b)</span><br><span class="line">&#123;</span><br><span class="line">    _Hp c;</span><br><span class="line">    c.len=a.len;</span><br><span class="line">    lxl x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=c.len;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        c.p[_]=a.p[_]*b+x;</span><br><span class="line">        x=c.p[_]/mod;</span><br><span class="line">        c.p[_]%=mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(x&gt;<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        c.p[++c.len]=x%mod;</span><br><span class="line">        x/=mod;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">_<span class="function">Hp <span class="title">max</span><span class="params">(<span class="keyword">const</span> _Hp &amp;a,<span class="keyword">const</span> _Hp &amp;b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a.len&gt;b.len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(a.len&lt;b.len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=a.len;_&gt;<span class="number">0</span>;--_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a.p[_]&gt;b.p[_])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> a;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(a.p[_]&lt;b.p[_])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">prework</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    prework();</span><br><span class="line">    <span class="keyword">while</span>(n--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(dp,<span class="number">0</span>,<span class="keyword">sizeof</span>(dp));</span><br><span class="line">        <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=m;++_)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cin</span>&gt;&gt;a[_];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=m;++_)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(R lxl __=m;__&gt;=_;--__)</span><br><span class="line">            &#123;</span><br><span class="line">                dp[_][__]=max(dp[_][__],dp[_<span class="number">-1</span>][__]+base[m-__+_<span class="number">-1</span>]*a[_<span class="number">-1</span>]);</span><br><span class="line">                dp[_][__]=max(dp[_][__],dp[_][__+<span class="number">1</span>]+base[m-__+_<span class="number">-1</span>]*a[__+<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        _Hp max_;</span><br><span class="line">        <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=m;++_)</span><br><span class="line">        &#123;</span><br><span class="line">            max_=max(max_,dp[_][_]+base[m]*a[_]);</span><br><span class="line">        &#125;</span><br><span class="line">        ans=ans+max_;</span><br><span class="line">    &#125;</span><br><span class="line">    ans.print();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">prework</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    base[<span class="number">0</span>].p[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    base[<span class="number">0</span>].len=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=m+<span class="number">2</span>;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        base[_]=base[_<span class="number">-1</span>]*<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="P4170-CQOI2007-涂色"><a href="#P4170-CQOI2007-涂色" class="headerlink" title="P4170 [CQOI2007]涂色"></a>P4170 [CQOI2007]涂色</h2><p><a href="https://www.luogu.org/problem/P4170" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="题目分析-4"><a href="#题目分析-4" class="headerlink" title="题目分析"></a>题目分析</h3><p>定义状态$f_{l,r}$表示区间($l,r$)的最少染色次数.</p>
<p>初始化每个长度为$1$的区间的最少次数为$1$.</p>
<p>如果$color_l = color_r$,那么可以视为第一次给这个区间涂色的时候直接多涂一格,可得$f_{l,r} = min(f_{l+1,r},f_{l,r-1},f_{l,r})$.</p>
<p>如果$color_l \neq color_r$,那么就视为在涂色的时候把区间分为两段分别来涂,即$f_{l,r}=min(f_{l,r},f_{l,k}+f_{k+1,r})$.</p>
<p>目标为$f_{1,n}$.</p>
<h3 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;<span class="meta-string">"\n"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n;</span><br><span class="line">lxl dp[<span class="number">51</span>][<span class="number">51</span>];</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">51</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dp));</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;s;</span><br><span class="line">    n=<span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">0</span>;_&lt;n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        dp[_][_]=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl len=<span class="number">2</span>;len&lt;=n;++len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl l=<span class="number">0</span>;l+len<span class="number">-1</span>&lt;n;++l)</span><br><span class="line">        &#123;</span><br><span class="line">            lxl r=l+len<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">if</span>(s[l]==s[r])</span><br><span class="line">            &#123;</span><br><span class="line">                dp[l][r]=min(dp[l][r],dp[l+<span class="number">1</span>][r]);</span><br><span class="line">                dp[l][r]=min(dp[l][r],dp[l][r<span class="number">-1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(R lxl k=l;k&lt;r;++k)</span><br><span class="line">                &#123;</span><br><span class="line">                    dp[l][r]=min(dp[l][r],dp[l][k]+dp[k+<span class="number">1</span>][r]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;dp[<span class="number">0</span>][n<span class="number">-1</span>]&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="P3205-HNOI2010-合唱队"><a href="#P3205-HNOI2010-合唱队" class="headerlink" title="P3205 [HNOI2010]合唱队"></a>P3205 [HNOI2010]合唱队</h2><p><a href="https://www.luogu.org/problem/P3205" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="题目分析-5"><a href="#题目分析-5" class="headerlink" title="题目分析"></a>题目分析</h3><p>定义状态$f_{l,r,opt}$,表示理想序列的一个子区间$(l,r)$,上一个人是站在左边或是右边的总方案数.其中$0$表示上一个人站在左边,$1$表示上一个人站在右边.</p>
<p>对于$f_{l,r,0}$,如果$high_l &lt; high_{l+1}$的话,由$f_{l+1,r,0}$转移而来,如果$high_l &lt; high_r$的话,由$f_{l+1,r,1}$转移而来.</p>
<p>对于$f_{l,r,1}$,如果$high_r &gt; high_l$的话,由$f_{l,r-1,0}$转移而来,如果$high_r &gt; high_{r-1}$的话,$f_{l,r-1,1}$转移而来.</p>
<p>目标为$dp_{1,n,0} + dp_{1,n,1}$.</p>
<h3 id="代码-5"><a href="#代码-5" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;<span class="meta-string">"\n"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 19650827</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n;</span><br><span class="line">lxl high[<span class="number">1010</span>],dp[<span class="number">1010</span>][<span class="number">1010</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;high[_];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        dp[_][_][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl len=<span class="number">2</span>;len&lt;=n;++len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl l=<span class="number">1</span>;l+len<span class="number">-1</span>&lt;=n;++l)</span><br><span class="line">        &#123;</span><br><span class="line">            lxl r=l+len<span class="number">-1</span>;</span><br><span class="line">            dp[l][r][<span class="number">0</span>]=(dp[l+<span class="number">1</span>][r][<span class="number">0</span>]*(high[l]&lt;high[l+<span class="number">1</span>])+dp[l+<span class="number">1</span>][r][<span class="number">1</span>]*(high[l]&lt;high[r]))%mod;</span><br><span class="line">            dp[l][r][<span class="number">1</span>]=(dp[l][r<span class="number">-1</span>][<span class="number">0</span>]*(high[r]&gt;high[l])+dp[l][r<span class="number">-1</span>][<span class="number">1</span>]*(high[r]&gt;high[r<span class="number">-1</span>]))%mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;(dp[<span class="number">1</span>][n][<span class="number">0</span>]+dp[<span class="number">1</span>][n][<span class="number">1</span>])%mod&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="P4302-SCOI2003-字符串折叠"><a href="#P4302-SCOI2003-字符串折叠" class="headerlink" title="P4302 [SCOI2003]字符串折叠"></a>P4302 [SCOI2003]字符串折叠</h2><p><a href="https://www.luogu.org/problem/P4302" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="题目分析-6"><a href="#题目分析-6" class="headerlink" title="题目分析"></a>题目分析</h3><p>定义状态$f_{l,r}$表示区间$(l,r)$的最小折叠长度.</p>
<p>初始化每个长度为$1$的区间的最小折叠长度为$1$.</p>
<p>对于一个区间,可以由两个小区间相加转移而来,于是得到$f_{l,r} = f_{l,k} + f_{k+1,r} (l \leq k &lt; r)$.</p>
<p>再枚举折叠区间的长度,暴力判断是否可以折叠,可以折叠的话由折叠成的小区间转移而来即可<del>科技为了我</del>.</p>
<h3 id="代码-6"><a href="#代码-6" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;<span class="meta-string">"\n"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n;</span><br><span class="line">lxl NumLen[<span class="number">110</span>],dp[<span class="number">110</span>][<span class="number">110</span>];</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">110</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">char</span>[],lxl,lxl)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dp));</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=<span class="number">9</span>;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        NumLen[_]=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">10</span>;_&lt;=<span class="number">99</span>;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        NumLen[_]=<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    NumLen[<span class="number">100</span>]=<span class="number">3</span>;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;s;</span><br><span class="line">    n=<span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">0</span>;_&lt;n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        dp[_][_]=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl len=<span class="number">2</span>;len&lt;=n;++len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl l=<span class="number">0</span>;l+len<span class="number">-1</span>&lt;n;++l)</span><br><span class="line">        &#123;</span><br><span class="line">            lxl r=l+len<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span>(R lxl k=l;k&lt;r;++k)</span><br><span class="line">            &#123;</span><br><span class="line">                dp[l][r]=min(dp[l][r],dp[l][k]+dp[k+<span class="number">1</span>][r]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(R lxl k=l;k&lt;r;++k)</span><br><span class="line">            &#123;</span><br><span class="line">                lxl CharLen=k-l+<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(len%CharLen!=<span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(check(s+l,len,CharLen))</span><br><span class="line">                &#123;</span><br><span class="line">                    dp[l][r]=min(dp[l][r],dp[l][k]+<span class="number">2</span>+NumLen[len/CharLen]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;dp[<span class="number">0</span>][n<span class="number">-1</span>]&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">char</span> s[],lxl n,lxl len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=len;_&lt;n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(s[_]!=s[_%len])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="P2470-SCOI2007-压缩"><a href="#P2470-SCOI2007-压缩" class="headerlink" title="P2470 [SCOI2007]压缩"></a>P2470 [SCOI2007]压缩</h2><p><a href="https://www.luogu.org/record/list?pid=P2470" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="题目分析-7"><a href="#题目分析-7" class="headerlink" title="题目分析"></a>题目分析</h3><p>定义状态$f_{l,r,opt}$,表示在$(l,r)$的区间内有无$M$的最小折叠长度,默认区间开始处有一个$M$.</p>
<p>首先如果区间长度是偶数且区间前半段和后半段相等的话,可以直接用$R$折叠.</p>
<p>然后考虑其他情况,对于区间里没有$M$的情况,枚举区间中的$k$,用$(l,k)$这一段区间的最小折叠长度加上区间剩余的长度,即只能用$R$从区间开始处的$M$处折叠.</p>
<p>得到$f_{l,r} = min(f_{l,k}+r-(k+1)+1) (l \leq k &lt; r)$.</p>
<p>对于区间中有$M$的情况,枚举$M$放在哪一个位置即可<del>科技为了我</del>.</p>
<p>目标为$min(dp_{1,n,0},dp_{1,n,1})$.</p>
<h3 id="代码-7"><a href="#代码-7" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;<span class="meta-string">"\n"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n;</span><br><span class="line">lxl dp[<span class="number">51</span>][<span class="number">51</span>][<span class="number">3</span>];</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">51</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(lxl,lxl)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dp));</span><br><span class="line"><span class="comment">//  cin&gt;&gt;(s+1);</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>,s+<span class="number">1</span>);</span><br><span class="line">    n=<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(R lxl l=<span class="number">1</span>;l&lt;=n;++l)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl r=l;r&lt;=n;++r)</span><br><span class="line">        &#123;</span><br><span class="line">            dp[l][r][<span class="number">0</span>]=dp[l][r][<span class="number">1</span>]=(r-l+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl len=<span class="number">2</span>;len&lt;=n;++len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl l=<span class="number">1</span>;l+len<span class="number">-1</span>&lt;=n;++l)</span><br><span class="line">        &#123;</span><br><span class="line">            lxl r=l+len<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">if</span>(check(l,r))</span><br><span class="line">            &#123;</span><br><span class="line">                dp[l][r][<span class="number">0</span>]=min(dp[l][r][<span class="number">0</span>],dp[l][(l+r)&gt;&gt;<span class="number">1</span>][<span class="number">0</span>]+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(R lxl k=l;k&lt;r;++k)</span><br><span class="line">            &#123;</span><br><span class="line">                dp[l][r][<span class="number">0</span>]=min(dp[l][r][<span class="number">0</span>],dp[l][k][<span class="number">0</span>]+r-k);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(R lxl k=l;k&lt;r;++k)</span><br><span class="line">            &#123;</span><br><span class="line">                dp[l][r][<span class="number">1</span>]=min(dp[l][r][<span class="number">1</span>],min(dp[l][k][<span class="number">0</span>],dp[l][k][<span class="number">1</span>])+min(dp[k+<span class="number">1</span>][r][<span class="number">0</span>],dp[k+<span class="number">1</span>][r][<span class="number">1</span>])+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;min(dp[<span class="number">1</span>][n][<span class="number">0</span>],dp[<span class="number">1</span>][n][<span class="number">1</span>])&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(lxl l,lxl r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((r-l+<span class="number">1</span>)&amp;<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    lxl mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=l;_&lt;=mid;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(s[_]!=s[_+mid-l+<span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="P3004-USACO10DEC-宝箱Treasure-Chest-amp-P2734-游戏-A-Game"><a href="#P3004-USACO10DEC-宝箱Treasure-Chest-amp-P2734-游戏-A-Game" class="headerlink" title="P3004 [USACO10DEC]宝箱Treasure Chest &amp; P2734 游戏 A Game"></a>P3004 [USACO10DEC]宝箱Treasure Chest &amp; P2734 游戏 A Game</h2><p><a href="https://www.luogu.org/problem/P3004" target="_blank" rel="noopener"><em>题面1</em></a></p>
<p><a href="https://www.luogu.org/problem/P2734" target="_blank" rel="noopener"><em>题面2</em></a></p>
<h3 id="题目分析-8"><a href="#题目分析-8" class="headerlink" title="题目分析"></a>题目分析</h3><p>定义状态$f_{l,r}$,表示取数的区间为$(l,r)$时的最优解.</p>
<p>根据可以在左边取或者是在右边取这一原则,很容易想出以下方程:</p>
<p>$f_{l,r} = pre_r - pre_{l-1} - min(f_{l+1,r},f_{l,r-1})$</p>
<p>其中的$pre$为前缀和,方便算出区间内的总值,再减去两边中小的那一边,就得到了更优的那一边.</p>
<p>目标为$f_{1,n}$.</p>
<p>但是第一道题这样的话是会爆空间的(当然第二道题不会),所以可以用到一个滚动数组优化.</p>
<p>$f_l$表示区间$(l,len-1)$的最优解,方程为:</p>
<p>$f_{l} = pre_r - pre_{l-1} - min(f_l,f_{l+1})$</p>
<p>目标为$f_1$.</p>
<h3 id="代码-8"><a href="#代码-8" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cctype"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;<span class="meta-string">"\n"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n;</span><br><span class="line">lxl pre[<span class="number">5010</span>],dp[<span class="number">5010</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;pre[_];</span><br><span class="line">        dp[_]=pre[_];</span><br><span class="line">        pre[_]+=pre[_<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl len=<span class="number">2</span>;len&lt;=n;++len)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(R lxl l=<span class="number">1</span>;l+len<span class="number">-1</span>&lt;=n;++l)</span><br><span class="line">        &#123;</span><br><span class="line">            lxl r=l+len<span class="number">-1</span>;</span><br><span class="line">            dp[l]=pre[r]-pre[l<span class="number">-1</span>]-min(dp[l],dp[l+<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;dp[<span class="number">1</span>]&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="树形DP"><a href="#树形DP" class="headerlink" title="树形DP"></a>树形DP</h1><p>在树上进行的$DP$.</p>
<p><a href="https://www.lemir3.red/2019/07/30/关于树形DP的工作报告/"><em>以前写的一篇树形$DP$总结</em></a></p>
<h2 id="P1273-有线电视网"><a href="#P1273-有线电视网" class="headerlink" title="P1273 有线电视网"></a>P1273 有线电视网</h2><p><a href="https://www.luogu.org/problem/P1273" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="题目分析-9"><a href="#题目分析-9" class="headerlink" title="题目分析"></a>题目分析</h3><p>定义状态$f_{i,j}$,表示在以$i$为根的子树上选$j$个节点的最大利润.</p>
<p>对于为用户终端的节点,直接赋为这个用户准备的费用.</p>
<p>对于一颗子树的根,先求出它子树的大小,然后枚举它的儿子节点选的个数,减去这个点与儿子连边的费用得到这个点的最优解.</p>
<p>得到如下状态转移方程:</p>
<p>$f_{from,j} = max(f_{from,i},f_{from,i-j} + f_{to,j} - val)$.</p>
<p>最后倒叙枚举一遍到根节点选的个数得到答案.</p>
<h3 id="代码-9"><a href="#代码-9" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;<span class="meta-string">"\n"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n,m,ESize;</span><br><span class="line">lxl head[<span class="number">3010</span>],dp[<span class="number">3010</span>][<span class="number">3010</span>],val[<span class="number">3010</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    lxl to,next,val;</span><br><span class="line">&#125;e[<span class="number">10010</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">EdgeAdd</span><span class="params">(lxl,lxl,lxl)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> lxl <span class="title">dfs</span><span class="params">(lxl)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">-0x3f</span>,<span class="keyword">sizeof</span>(dp));</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n-m;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        lxl size;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;size;</span><br><span class="line">        <span class="keyword">for</span>(R lxl __=<span class="number">1</span>;__&lt;=size;++__)</span><br><span class="line">        &#123;</span><br><span class="line">            lxl to,val;</span><br><span class="line">            <span class="built_in">cin</span>&gt;&gt;to&gt;&gt;val;</span><br><span class="line">            EdgeAdd(_,to,val);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=n-m+<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;val[_];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        dp[_][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=m;_&gt;=<span class="number">1</span>;--_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(dp[<span class="number">1</span>][_]&gt;=<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;_&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">EdgeAdd</span><span class="params">(lxl from,lxl to,lxl val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[++ESize].to=to;</span><br><span class="line">    e[ESize].val=val;</span><br><span class="line">    e[ESize].next=head[from];</span><br><span class="line">    head[from]=ESize;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> lxl <span class="title">dfs</span><span class="params">(lxl from)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(from&gt;n-m)</span><br><span class="line">    &#123;</span><br><span class="line">        dp[from][<span class="number">1</span>]=val[from];</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    lxl sum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=head[from];~_;_=e[_].next)</span><br><span class="line">    &#123;</span><br><span class="line">        lxl to=e[_].to;</span><br><span class="line">        lxl val=e[_].val;</span><br><span class="line">        lxl SonSize=dfs(to);</span><br><span class="line">        sum+=SonSize;</span><br><span class="line">        <span class="keyword">for</span>(R lxl __=sum;__&gt;<span class="number">0</span>;--__)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(R lxl ___=<span class="number">1</span>;___&lt;=SonSize;++___)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(__-___&gt;=<span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    dp[from][__]=max(dp[from][__],dp[from][__-___]+dp[to][___]-val);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="P1272-重建道路"><a href="#P1272-重建道路" class="headerlink" title="P1272 重建道路"></a>P1272 重建道路</h2><p><a href="https://www.luogu.org/problem/P1272" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="题目分析-10"><a href="#题目分析-10" class="headerlink" title="题目分析"></a>题目分析</h3><h3 id="代码-10"><a href="#代码-10" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cctype"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;<span class="meta-string">"\n"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n,p,ESize,ans=INF;</span><br><span class="line">lxl head[<span class="number">200</span>],dp[<span class="number">200</span>][<span class="number">200</span>],size[<span class="number">200</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    lxl to,next;</span><br><span class="line">&#125;e[<span class="number">400010</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">EdgeAdd</span><span class="params">(lxl,lxl)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> lxl <span class="title">dfs1</span><span class="params">(lxl)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(lxl)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dp));</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;p;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n<span class="number">-1</span>;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        lxl from,to;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;from&gt;&gt;to;</span><br><span class="line">        EdgeAdd(from,to);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs1(<span class="number">1</span>);</span><br><span class="line"><span class="comment">/*  for(R lxl _=1;_&lt;=n;++_)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        debug(size[_]);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    dp[<span class="number">1</span>][size[<span class="number">1</span>]]=<span class="number">0</span>;</span><br><span class="line">    dfs2(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">EdgeAdd</span><span class="params">(lxl from,lxl to)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[++ESize].to=to;</span><br><span class="line">    e[ESize].next=head[from];</span><br><span class="line">    head[from]=ESize;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> lxl <span class="title">dfs1</span><span class="params">(lxl from)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    size[from]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=head[from];~_;_=e[_].next)</span><br><span class="line">    &#123;</span><br><span class="line">        lxl to=e[_].to;</span><br><span class="line">        size[from]+=dfs1(to);</span><br><span class="line">    &#125;</span><br><span class="line">    dp[from][size[from]]=<span class="number">1</span>;</span><br><span class="line">    dp[from][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> size[from];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(lxl from)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=head[from];~_;_=e[_].next)</span><br><span class="line">    &#123;</span><br><span class="line">        lxl to=e[_].to;</span><br><span class="line">        dfs2(to);</span><br><span class="line">        <span class="keyword">for</span>(R lxl __=size[from]<span class="number">-1</span>;__&gt;=<span class="number">0</span>;--__)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(R lxl ___=<span class="number">0</span>;___&lt;=__;++___)</span><br><span class="line">            &#123;</span><br><span class="line">                dp[from][__]=min(dp[from][__],dp[from][__-___]+dp[to][___]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(size[from]-p&gt;=<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ans=min(ans,dp[from][size[from]-p]+dp[from][size[from]]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="P3267-JLOI2016-SHOI2016-侦察守卫"><a href="#P3267-JLOI2016-SHOI2016-侦察守卫" class="headerlink" title="P3267 [JLOI2016/SHOI2016]侦察守卫"></a>P3267 [JLOI2016/SHOI2016]侦察守卫</h2><p><a href="https://www.luogu.org/problem/P3267" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="题目分析-11"><a href="#题目分析-11" class="headerlink" title="题目分析"></a>题目分析</h3><h3 id="代码-11"><a href="#代码-11" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;<span class="meta-string">"\n"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n,m,d,ESize;</span><br><span class="line">lxl w[<span class="number">500010</span>],head[<span class="number">500010</span>],dp1[<span class="number">500010</span>][<span class="number">21</span>],dp2[<span class="number">500010</span>][<span class="number">21</span>];</span><br><span class="line"><span class="keyword">bool</span> key[<span class="number">500010</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    lxl to,next;</span><br><span class="line">&#125;e[<span class="number">1000010</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">EdgeAdd</span><span class="params">(lxl,lxl)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(lxl,lxl)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;d;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;w[_];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=m;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        lxl a;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;a;</span><br><span class="line">        key[a]=<span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n<span class="number">-1</span>;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        lxl from,to;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;from&gt;&gt;to;</span><br><span class="line">        EdgeAdd(from,to);</span><br><span class="line">        EdgeAdd(to,from);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;dp1[<span class="number">1</span>][<span class="number">0</span>]&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">EdgeAdd</span><span class="params">(lxl from,lxl to)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[++ESize].to=to;</span><br><span class="line">    e[ESize].next=head[from];</span><br><span class="line">    head[from]=ESize;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(lxl from,lxl stalin)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dp1[from][<span class="number">0</span>]=dp2[from][<span class="number">0</span>]=key[from]?w[from]:<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=d;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        dp2[from][_]=w[from];</span><br><span class="line">    &#125;</span><br><span class="line">    dp2[from][d+<span class="number">1</span>]=INF;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=head[from];~_;_=e[_].next)</span><br><span class="line">    &#123;</span><br><span class="line">        lxl to=e[_].to;</span><br><span class="line">        <span class="keyword">if</span>(to!=stalin)</span><br><span class="line">        &#123;</span><br><span class="line">            dfs(to,from);</span><br><span class="line">            <span class="keyword">for</span>(R lxl _=<span class="number">0</span>;_&lt;=d;++_)</span><br><span class="line">            &#123;</span><br><span class="line">                dp2[from][_]=min(dp2[from][_]+dp1[to][_],dp1[from][_+<span class="number">1</span>]+dp2[to][_+<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(R lxl _=d;_&gt;=<span class="number">0</span>;--_)</span><br><span class="line">            &#123;</span><br><span class="line">                dp2[from][_]=min(dp2[from][_],dp2[from][_+<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            dp1[from][<span class="number">0</span>]=dp2[from][<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=d;++_)</span><br><span class="line">            &#123;</span><br><span class="line">                dp1[from][_]+=dp1[to][_<span class="number">-1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=d;++_)</span><br><span class="line">            &#123;</span><br><span class="line">                dp1[from][_]=min(dp1[from][_],dp1[from][_<span class="number">-1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="P2796-Facer的程序"><a href="#P2796-Facer的程序" class="headerlink" title="P2796 Facer的程序"></a>P2796 Facer的程序</h2><p><a href="https://www.luogu.org/problem/P2796" target="_blank" rel="noopener"><em>题面</em></a></p>
<h3 id="题目分析-12"><a href="#题目分析-12" class="headerlink" title="题目分析"></a>题目分析</h3><h3 id="代码-12"><a href="#代码-12" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"iostream"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstring"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdio"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"algorithm"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cmath"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cstdlib"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"cctype"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lxl long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> R register</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 2147483647</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(x) cout&lt;&lt;<span class="meta-string">"debug:"</span>&lt;&lt;x&lt;&lt;<span class="meta-string">"\n"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 1000000007</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">lxl n,ESzie,ans;</span><br><span class="line">lxl head[<span class="number">100010</span>],dp[<span class="number">100010</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    lxl next,to;</span><br><span class="line">&#125;e[<span class="number">200010</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">EdgeAdd</span><span class="params">(lxl,lxl)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(lxl,lxl)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=<span class="number">1</span>;_&lt;=n<span class="number">-1</span>;++_)</span><br><span class="line">    &#123;</span><br><span class="line">        lxl from,to;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;from&gt;&gt;to;</span><br><span class="line">        EdgeAdd(from,to);</span><br><span class="line">        EdgeAdd(to,from);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">EdgeAdd</span><span class="params">(lxl from,lxl to)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[++ESzie].to=to;</span><br><span class="line">    e[ESzie].next=head[from];</span><br><span class="line">    head[from]=ESzie;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(lxl from,lxl stalin)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    dp[from]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(R lxl _=head[from];~_;_=e[_].next)</span><br><span class="line">    &#123;</span><br><span class="line">        lxl to=e[_].to;</span><br><span class="line">        <span class="keyword">if</span>(to==stalin)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        dfs(to,from);</span><br><span class="line">        dp[from]=(dp[from]+dp[to]*dp[from]%mod)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    ans=(ans+dp[from])%mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      </div>
      <div class="post-copyright">
    <p class="copyright-item">
      <span>Author: </span>
      <a href="https://www.lemir3.red">lemir3</a>
    </p>
    <p class="copyright-item">
      <span>Link: </span>
      <a href="https://www.lemir3.red/2019/08/31/pao-da-dp-yun-dong-zong-jie/">https://www.lemir3.red/2019/08/31/pao-da-dp-yun-dong-zong-jie/</a>
    </p>
    <p class="copyright-item">
      <span>License: </span><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>
    </p>
  </div>
      <footer class="post-footer">
        <div class="post-tags">
            <a href="/tags/动态规划/">动态规划</a>
            </div>
        
        <nav class="post-nav"><a class="prev" href="/2019/09/06/ji-ke-ke-ji-da-xue-yong-dong-ji-xi-ya-wei-gao-jing-ji-zhu-qu-de-tu-po-xing-jin-zhan/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">即可科技大学永动机系压位高精技术取得突破性进展</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    <a class="next" href="/2019/08/31/chai-fen-qi-si-xiang/">
        <span class="next-text nav-default">差分其思想</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></footer>
    </article></div><div class="comments" id="comments"><div id="gitalk-container"></div>
    </div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:lemir3@outlook.com" class="iconfont icon-email" title="email"></a>
        <a href="https://github.com/lemir3" class="iconfont icon-github" title="github"></a>
        <a href="https://www.zhihu.com/people/lemir3" class="iconfont icon-zhihu" title="zhihu"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2019 - 2020<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">lemir3</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>


<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">


<script src="//cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js"></script>

<script>
  var gitalk = new Gitalk({
    clientID: '670bf3ed0a83fdca6808',
    clientSecret: '9ea030854681b4438efa115f56dfe069f38f33d3',
    repo: 'lemir3.github.io',
    owner: 'lemir3',
    admin: ['lemir3'],
    id: md5(location.pathname),
    
      language: 'en',
    
    distractionFreeMode: 'true'
  });
  gitalk.render('gitalk-container');
</script><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
<link rel="stylesheet" href="\css\APlayer.min.css">
  <script src="\js\APlayer.min.js"></script>
  <div id="aplayer" class="aplayer" data-id="3220766973" data-server="netease" data-type="playlist" data-fixed="true" data-listfolded="true" data-order="random" data-theme="#ff0000b3"></div>
  <script src="\js\Meting.min.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
  </body>
</html>
